"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[590],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var r=s(6540);const l={},i=r.createContext(l);function t(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(i.Provider,{value:n},e.children)}},8930:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"cron/troubleshooting","title":"D\xe9pannage","description":"Guide pour r\xe9soudre les probl\xe8mes courants du syst\xe8me de mise \xe0 jour automatique.","source":"@site/docs/cron/troubleshooting.md","sourceDirName":"cron","slug":"/cron/troubleshooting","permalink":"/documentation/cron/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/loukalost/adopte-ton-triple-monstre/tree/main/documentation/docs/cron/troubleshooting.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"D\xe9pannage"},"sidebar":"tutorialSidebar","previous":{"title":"R\xe9f\xe9rence API","permalink":"/documentation/cron/api-reference"}}');var l=s(4848),i=s(8453);const t={sidebar_position:5,title:"D\xe9pannage"},o="\ud83d\udd27 D\xe9pannage",c={},d=[{value:"\ud83d\udea8 Probl\xe8mes courants",id:"-probl\xe8mes-courants",level:2},{value:"Aucun log n&#39;appara\xeet dans la console",id:"aucun-log-nappara\xeet-dans-la-console",level:3},{value:"Erreur &quot;Unauthorized&quot; (401)",id:"erreur-unauthorized-401",level:3},{value:"Les monstres ne changent pas d&#39;\xe9tat",id:"les-monstres-ne-changent-pas-d\xe9tat",level:3},{value:"Erreur &quot;Connection to database failed&quot;",id:"erreur-connection-to-database-failed",level:3},{value:"Les mises \xe0 jour sont trop fr\xe9quentes/rares",id:"les-mises-\xe0-jour-sont-trop-fr\xe9quentesrares",level:3},{value:"L&#39;indicateur visuel ne s&#39;affiche pas",id:"lindicateur-visuel-ne-saffiche-pas",level:3},{value:"Erreur &quot;Module not found: Can&#39;t resolve &#39;@/db&#39;&quot;",id:"erreur-module-not-found-cant-resolve-db",level:3},{value:"Les mises \xe0 jour ne s&#39;arr\xeatent pas",id:"les-mises-\xe0-jour-ne-sarr\xeatent-pas",level:3},{value:"Performance : Trop de mises \xe0 jour en base",id:"performance--trop-de-mises-\xe0-jour-en-base",level:3},{value:"\ud83e\uddea Outils de diagnostic",id:"-outils-de-diagnostic",level:2},{value:"1. Tester l&#39;API manuellement",id:"1-tester-lapi-manuellement",level:3},{value:"2. Activer tous les logs",id:"2-activer-tous-les-logs",level:3},{value:"3. V\xe9rifier l&#39;\xe9tat du hook",id:"3-v\xe9rifier-l\xe9tat-du-hook",level:3},{value:"4. Monitoring Vercel (production)",id:"4-monitoring-vercel-production",level:3},{value:"\ud83d\udcca Checklist de v\xe9rification",id:"-checklist-de-v\xe9rification",level:2},{value:"\ud83c\udd98 Support",id:"-support",level:2},{value:"\ud83d\udca1 Conseils g\xe9n\xe9raux",id:"-conseils-g\xe9n\xe9raux",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"-d\xe9pannage",children:"\ud83d\udd27 D\xe9pannage"})}),"\n",(0,l.jsx)(n.p,{children:"Guide pour r\xe9soudre les probl\xe8mes courants du syst\xe8me de mise \xe0 jour automatique."}),"\n",(0,l.jsx)(n.h2,{id:"-probl\xe8mes-courants",children:"\ud83d\udea8 Probl\xe8mes courants"}),"\n",(0,l.jsx)(n.h3,{id:"aucun-log-nappara\xeet-dans-la-console",children:"Aucun log n'appara\xeet dans la console"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"La console du navigateur est vide"}),"\n",(0,l.jsx)(n.li,{children:"Aucune trace du syst\xe8me de mise \xe0 jour"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier que verbose est activ\xe9"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  verbose={true}  // \u2190 Doit \xeatre true\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier la console du navigateur"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Appuyez sur ",(0,l.jsx)(n.code,{children:"F12"})]}),"\n",(0,l.jsxs)(n.li,{children:["Allez dans l'onglet ",(0,l.jsx)(n.strong,{children:"Console"})]}),"\n",(0,l.jsxs)(n.li,{children:["Recherchez ",(0,l.jsx)(n.code,{children:"[AUTO-UPDATE]"})," dans le filtre"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier que le composant est mont\xe9"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Ajoutez temporairement :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  showIndicator={true}  // \u2190 Badge visible\r\n  verbose\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"erreur-unauthorized-401",children:'Erreur "Unauthorized" (401)'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[AUTO-UPDATE] \u274c Erreur lors de la mise \xe0 jour { status: 401, error: 'Unauthorized' }\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Cause :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Les tokens ne correspondent pas"}),"\n",(0,l.jsx)(n.li,{children:"Token manquant c\xf4t\xe9 client"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsxs)(n.strong,{children:["V\xe9rifier ",(0,l.jsx)(n.code,{children:".env.local"})]})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-env",children:"CRON_SECRET_TOKEN=votre_token_secret\r\nNEXT_PUBLIC_CRON_SECRET_TOKEN=votre_token_secret  # \u2190 Doit \xeatre identique\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Red\xe9marrer le serveur"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Arr\xeater le serveur (Ctrl+C)\r\nnpm run dev\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Sur Vercel"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Allez dans Settings > Environment Variables et v\xe9rifiez que les deux variables ont la m\xeame valeur."}),"\n",(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"D\xe9sactiver l'authentification (temporairement)"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Supprimez ou commentez les variables dans ",(0,l.jsx)(n.code,{children:".env.local"})," :"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-env",children:"# CRON_SECRET_TOKEN=...\r\n# NEXT_PUBLIC_CRON_SECRET_TOKEN=...\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"les-monstres-ne-changent-pas-d\xe9tat",children:"Les monstres ne changent pas d'\xe9tat"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Les logs montrent des mises \xe0 jour r\xe9ussies"}),"\n",(0,l.jsx)(n.li,{children:"Mais les \xe9tats ne changent pas en base de donn\xe9es"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier la connexion MongoDB"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Testez manuellement l'API :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:3000/api/cron/update-monsters\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier les logs API"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Dans le terminal o\xf9 tourne ",(0,l.jsx)(n.code,{children:"npm run dev"}),", cherchez :"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[CRON-UPDATE-MONSTERS] [INFO] \u2728 Monstre xxx \u2192 hungry => sleepy\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier dans MongoDB"})}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ouvrez MongoDB Compass"}),"\n",(0,l.jsxs)(n.li,{children:["Regardez la collection ",(0,l.jsx)(n.code,{children:"monsters"})]}),"\n",(0,l.jsxs)(n.li,{children:["V\xe9rifiez le champ ",(0,l.jsx)(n.code,{children:"state"})," et ",(0,l.jsx)(n.code,{children:"updatedAt"})]}),"\n"]}),"\n",(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier qu'il y a des monstres"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl http://localhost:3000/api/cron/update-monsters\r\n# Regardez le champ "updated" dans la r\xe9ponse\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Si ",(0,l.jsx)(n.code,{children:"updated: 0"}),", il n'y a pas de monstres dans la base."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"erreur-connection-to-database-failed",children:'Erreur "Connection to database failed"'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[CRON-UPDATE-MONSTERS] [ERROR] \u274c Erreur lors de la mise \xe0 jour: Connection to database failed\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsxs)(n.strong,{children:["V\xe9rifier ",(0,l.jsx)(n.code,{children:".env.local"})]})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-env",children:"MONGODB_USERNAME=your_username\r\nMONGODB_PASSWORD=your_password\r\nMONGODB_HOST=cluster.mongodb.net\r\nMONGODB_DATABASE_NAME=tamagotcho\r\nMONGODB_PARAMS=?retryWrites=true&w=majority\r\nMONGODB_APP_NAME=tamagotcho\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Tester la connexion MongoDB"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Cr\xe9ez un script de test :"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// test-db.js\r\nimport clientPromise from './src/db/index.js'\r\n\r\nasync function testConnection() {\r\n  try {\r\n    const client = await clientPromise\r\n    console.log('\u2705 Connexion r\xe9ussie')\r\n    const db = client.db()\r\n    const collections = await db.listCollections().toArray()\r\n    console.log('Collections:', collections.map(c => c.name))\r\n  } catch (error) {\r\n    console.error('\u274c Erreur:', error)\r\n  }\r\n}\r\n\r\ntestConnection()\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier les IP autoris\xe9es sur MongoDB Atlas"})}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Allez sur MongoDB Atlas"}),"\n",(0,l.jsx)(n.li,{children:"Network Access > Add IP Address"}),"\n",(0,l.jsxs)(n.li,{children:["Ajoutez ",(0,l.jsx)(n.code,{children:"0.0.0.0/0"})," (pour autoriser toutes les IPs en dev)"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"les-mises-\xe0-jour-sont-trop-fr\xe9quentesrares",children:"Les mises \xe0 jour sont trop fr\xe9quentes/rares"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Probl\xe8me :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Les mises \xe0 jour se font trop souvent"}),"\n",(0,l.jsx)(n.li,{children:"Ou trop rarement"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier la configuration"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={60000}   // 1 minute min\r\n  maxInterval={180000}  // 3 minutes max\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Pour ralentir"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={300000}  // 5 minutes min\r\n  maxInterval={600000}  // 10 minutes max\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Pour acc\xe9l\xe9rer (dev uniquement)"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={10000}   // 10 secondes min\r\n  maxInterval={30000}   // 30 secondes max\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"lindicateur-visuel-ne-saffiche-pas",children:"L'indicateur visuel ne s'affiche pas"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"showIndicator={true}"})," mais rien ne s'affiche"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier le z-index"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["L'indicateur utilise ",(0,l.jsx)(n.code,{children:"z-50"}),". Assurez-vous qu'aucun autre \xe9l\xe9ment n'a un z-index sup\xe9rieur."]}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifier dans la console"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// Dans la console du navigateur\r\ndocument.querySelector('[role=\"status\"]')\r\n// Devrait retourner un \xe9l\xe9ment\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Cr\xe9er votre propre indicateur"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"'use client'\r\n\r\nimport { useAutoUpdateMonsters } from '@/hooks/use-auto-update-monsters'\r\n\r\nexport function MyIndicator() {\r\n  const { isUpdating, updateCount } = useAutoUpdateMonsters()\r\n  \r\n  return (\r\n    <div className=\"fixed top-4 right-4 bg-blue-500 text-white p-2\">\r\n      {isUpdating ? '\ud83d\udd04' : '\u2705'} {updateCount} mises \xe0 jour\r\n    </div>\r\n  )\r\n}\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"erreur-module-not-found-cant-resolve-db",children:"Erreur \"Module not found: Can't resolve '@/db'\""}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Error: Module not found: Can't resolve '@/db'\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solution :"})}),"\n",(0,l.jsxs)(n.p,{children:["V\xe9rifiez que ",(0,l.jsx)(n.code,{children:"src/db/index.ts"})," exporte bien ",(0,l.jsx)(n.code,{children:"clientPromise"})," :"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"// src/db/index.ts\r\nexport default clientPromise\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"les-mises-\xe0-jour-ne-sarr\xeatent-pas",children:"Les mises \xe0 jour ne s'arr\xeatent pas"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Les mises \xe0 jour continuent m\xeame apr\xe8s avoir ferm\xe9 l'onglet"}),"\n",(0,l.jsx)(n.li,{children:"Multiples instances qui tournent"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Cause :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Chaque onglet ouvert lance sa propre instance"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solution normale :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"C'est le comportement attendu"}),"\n",(0,l.jsx)(n.li,{children:"Chaque onglet est ind\xe9pendant"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Pour arr\xeater :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Fermez tous les onglets"}),"\n",(0,l.jsx)(n.li,{children:"Ou d\xe9sactivez temporairement :"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  enabled={false}  // \u2190 Arr\xeat temporaire\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"performance--trop-de-mises-\xe0-jour-en-base",children:"Performance : Trop de mises \xe0 jour en base"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sympt\xf4mes :"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Charge \xe9lev\xe9e sur MongoDB"}),"\n",(0,l.jsx)(n.li,{children:"Co\xfbts \xe9lev\xe9s"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Augmenter les intervalles"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  minInterval={300000}  // 5 min\r\n  maxInterval={900000}  // 15 min\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Limiter le nombre de monstres mis \xe0 jour"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Modifiez ",(0,l.jsx)(n.code,{children:"src/app/api/cron/update-monsters/route.ts"})," :"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"// Mettre \xe0 jour seulement 10 monstres al\xe9atoires au lieu de tous\r\nconst monsters = await monstersCollection\r\n  .find({})\r\n  .limit(10)  // \u2190 Limiter\r\n  .toArray()\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"D\xe9sactiver en production"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  enabled={process.env.NODE_ENV !== 'production'}\r\n  // ...\r\n/>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-outils-de-diagnostic",children:"\ud83e\uddea Outils de diagnostic"}),"\n",(0,l.jsx)(n.h3,{id:"1-tester-lapi-manuellement",children:"1. Tester l'API manuellement"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -v http://localhost:3000/api/cron/update-monsters\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-activer-tous-les-logs",children:"2. Activer tous les logs"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"<MonstersAutoUpdater\r\n  verbose={true}\r\n  showIndicator={true}\r\n  minInterval={10000}\r\n  maxInterval={10000}  // Fixe pour debug\r\n  enabled\r\n/>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-v\xe9rifier-l\xe9tat-du-hook",children:"3. V\xe9rifier l'\xe9tat du hook"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"'use client'\r\n\r\nimport { useAutoUpdateMonsters } from '@/hooks/use-auto-update-monsters'\r\n\r\nexport function DebugCron() {\r\n  const state = useAutoUpdateMonsters()\r\n  \r\n  return (\r\n    <div className=\"fixed bottom-0 left-0 bg-black text-white p-4 text-xs\">\r\n      <pre>{JSON.stringify(state, null, 2)}</pre>\r\n    </div>\r\n  )\r\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-monitoring-vercel-production",children:"4. Monitoring Vercel (production)"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Allez sur Vercel Dashboard"}),"\n",(0,l.jsx)(n.li,{children:"S\xe9lectionnez votre projet"}),"\n",(0,l.jsxs)(n.li,{children:["Onglet ",(0,l.jsx)(n.strong,{children:"Functions"})]}),"\n",(0,l.jsxs)(n.li,{children:["Filtrez par ",(0,l.jsx)(n.code,{children:"/api/cron/update-monsters"})]}),"\n",(0,l.jsx)(n.li,{children:"Examinez les logs et performances"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-checklist-de-v\xe9rification",children:"\ud83d\udcca Checklist de v\xe9rification"}),"\n",(0,l.jsx)(n.p,{children:"Avant de demander de l'aide, v\xe9rifiez :"}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,l.jsx)(n.code,{children:"npm run dev"})," tourne sans erreur"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,l.jsx)(n.code,{children:".env.local"})," est correctement configur\xe9"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","MongoDB est accessible"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Il y a au moins 1 monstre en base"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","La console du navigateur est ouverte"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,l.jsx)(n.code,{children:"verbose={true}"})," est activ\xe9"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Les tokens correspondent (si auth activ\xe9e)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Vous avez essay\xe9 de red\xe9marrer le serveur"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Vous avez test\xe9 l'API manuellement avec curl"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-support",children:"\ud83c\udd98 Support"}),"\n",(0,l.jsx)(n.p,{children:"Si le probl\xe8me persiste :"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"V\xe9rifiez les logs complets"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Console navigateur (F12)"}),"\n",(0,l.jsxs)(n.li,{children:["Terminal ",(0,l.jsx)(n.code,{children:"npm run dev"})]}),"\n",(0,l.jsx)(n.li,{children:"Logs Vercel (production)"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Consultez la documentation"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/documentation/cron/quickstart",children:"Guide de d\xe9marrage"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/documentation/cron/configuration",children:"Configuration"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/documentation/cron/api-reference",children:"R\xe9f\xe9rence API"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Cherchez dans les issues GitHub"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Peut-\xeatre que quelqu'un a eu le m\xeame probl\xe8me"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Cr\xe9ez une issue"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Incluez les logs"}),"\n",(0,l.jsx)(n.li,{children:"D\xe9crivez les \xe9tapes pour reproduire"}),"\n",(0,l.jsx)(n.li,{children:"Mentionnez votre configuration"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-conseils-g\xe9n\xe9raux",children:"\ud83d\udca1 Conseils g\xe9n\xe9raux"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Commencez simple"})," : Utilisez la configuration par d\xe9faut"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Logs d'abord"})," : Activez toujours ",(0,l.jsx)(n.code,{children:"verbose"})," en dev"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Testez l'API"})," : curl est votre ami"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MongoDB"})," : 90% des probl\xe8mes viennent de l\xe0"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Red\xe9marrez"})," : Souvent la solution la plus simple"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);